# Sprint 130: AI Schedule Optimizer â€” Implementation Brief

> **Generated:** 2026-02-06
> **Generated By:** Roadmap Planning Session (Phase 20: AI & Intelligence)
> **Status:** Ready for Implementation (skip plan mode)
> **Priority:** P1 | **Hours:** 8-10

---

## Overview

Smart scheduling that considers weather, crew availability, task dependencies, and trade sequencing. "Optimize Schedule" button analyzes current schedule and suggests improvements. Also replaces mock weather data with a real weather API.

---

## Existing Infrastructure

### Hooks & Components
| Item | File | Notes |
|------|------|-------|
| useScheduleEvents | lib/hooks/useScheduleEvents.ts | Schedule CRUD + real-time |
| useSchedule | lib/hooks/useSchedule.ts | Schedule management |
| useAvailability | lib/hooks/useAvailability.ts | Team availability |
| WeatherWidget | components/schedule/WeatherWidget.tsx | Currently uses mock data |
| ConflictAlert | components/schedule/ConflictAlert.tsx | Scheduling conflict detection |
| lib/services/weather.ts | Weather service | Mock implementation |

---

## Files to Create

| # | File Path | Purpose | Pattern |
|---|-----------|---------|---------|
| 1 | app/api/ai/optimize-schedule/route.ts | AI schedule optimization API | assistant/route.ts |
| 2 | lib/ai/schedule-optimizer.ts | Optimization logic + prompts | estimate-generator.ts |
| 3 | lib/services/weather-api.ts | Real weather API integration | Replace mock |
| 4 | components/schedule/ScheduleOptimizer.tsx | Optimization UI with suggestions | Modal + list |
| 5 | components/schedule/OptimizationSuggestion.tsx | Individual suggestion card | Card pattern |

## Files to Modify

| # | File Path | What Changes |
|---|-----------|-------------|
| 1 | components/schedule/WeatherWidget.tsx | Use real weather API |
| 2 | lib/services/weather.ts | Replace mock with real API calls |
| 3 | app/dashboard/schedule/page.tsx | Add "Optimize Schedule" button |

---

## Parallel Work Plan

### Batch 1
| Agent | Task | Est. Tokens |
|-------|------|-------------|
| Agent 1 | Real weather API integration (replace mock) | ~20k |
| Agent 2 | Schedule optimizer prompt engine | ~25k |
| Agent 3 | Optimizer UI components | ~20k |

### Batch 2
| Agent | Task | Est. Tokens |
|-------|------|-------------|
| Agent 1 | API route + integration with schedule page | ~25k |

---

## Acceptance Criteria

- [ ] WeatherWidget shows real weather data (not mock)
- [ ] "Optimize Schedule" button on schedule page
- [ ] AI suggests task reordering based on weather + dependencies
- [ ] One-click apply suggestions
- [ ] Conflict detection for overlapping crew/weather risks
- [ ] npx tsc --noEmit passes

---

## Estimated Token Budget: ~90k
