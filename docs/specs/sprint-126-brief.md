# Sprint 126: Google Calendar & Apple Calendar Sync â€” Implementation Brief

> **Generated:** 2026-02-06
> **Generated By:** Roadmap Planning Session (Phase 19: Integrations)
> **Status:** Ready for Implementation (skip plan mode)
> **Priority:** P1 | **Hours:** 8-10

---

## Overview

Sync ContractorOS schedule events to Google Calendar and generate .ics files for Apple Calendar. Two-way sync optional (pull Google events read-only).

---

## Existing Infrastructure

### Hooks
| Hook | File | Notes |
|------|------|-------|
| useScheduleEvents | lib/hooks/useScheduleEvents.ts | Schedule CRUD + real-time |
| useSchedule | lib/hooks/useSchedule.ts | Schedule management |

### Pages
| Route | File | Notes |
|-------|------|-------|
| /dashboard/schedule | app/dashboard/schedule/page.tsx | Schedule page with calendar view |

---

## Files to Create

| # | File Path | Purpose | Pattern |
|---|-----------|---------|---------|
| 1 | lib/integrations/google-calendar/oauth.ts | Google OAuth + Calendar API | QBO oauth.ts |
| 2 | lib/integrations/google-calendar/sync.ts | Push/pull events | QBO sync pattern |
| 3 | app/api/integrations/calendar/connect/route.ts | Google OAuth flow | QBO connect route |
| 4 | app/api/integrations/calendar/callback/route.ts | OAuth callback | QBO callback route |
| 5 | app/api/integrations/calendar/sync/route.ts | Trigger sync | QBO sync route |
| 6 | lib/utils/ics-generator.ts | Generate .ics files | Pure utility |
| 7 | app/api/calendar/export/route.ts | Download .ics file | API route |
| 8 | components/settings/GoogleCalendarSync.tsx | Settings UI | QBOSyncStatus pattern |
| 9 | lib/hooks/useCalendarConnection.ts | Connection status | useAccountingConnection |
| 10 | app/dashboard/settings/integrations/calendar/page.tsx | Calendar settings | QBO settings page |

---

## Parallel Work Plan

### Batch 1 (No Dependencies)
| Agent | Task | Est. Tokens |
|-------|------|-------------|
| Agent 1 | Google OAuth + Calendar API lib | ~25k |
| Agent 2 | .ics generator utility | ~10k |
| Agent 3 | Calendar connection hook + settings page | ~20k |

### Batch 2 (Depends on Batch 1)
| Agent | Task | Est. Tokens |
|-------|------|-------------|
| Agent 1 | API routes (connect, callback, sync, export) | ~30k |
| Agent 2 | Push schedule events to Google Calendar | ~20k |

---

## Acceptance Criteria

- [ ] Events created in ContractorOS appear in Google Calendar within 30s
- [ ] .ics download works for individual events and full calendar
- [ ] Two-way sync toggle in settings
- [ ] Sync status indicator on schedule page
- [ ] npx tsc --noEmit passes

---

## Estimated Token Budget: ~105k
