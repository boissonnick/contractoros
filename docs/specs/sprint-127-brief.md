# Sprint 127: Xero Accounting Integration — Implementation Brief

> **Generated:** 2026-02-06
> **Generated By:** Roadmap Planning Session (Phase 19: Integrations)
> **Status:** Ready for Implementation (skip plan mode)
> **Priority:** P2 | **Hours:** 10-14

---

## Overview

Second accounting platform integration. Mirror the QBO pattern: Xero OAuth 2.0, contact sync, invoice sync, expense sync, account mapping UI.

---

## Existing Infrastructure (QBO Pattern to Follow)

| QBO File | Purpose | Xero Equivalent |
|----------|---------|-----------------|
| lib/integrations/quickbooks/oauth.ts | OAuth flow | lib/integrations/xero/oauth.ts |
| lib/integrations/quickbooks/sync-expenses.ts | Expense sync | lib/integrations/xero/sync-expenses.ts |
| lib/hooks/useAccountingConnection.ts | Connection hook | Reuse (add Xero provider) |
| components/settings/QBOAccountMapping.tsx | Account mapping UI | components/settings/XeroAccountMapping.tsx |
| components/settings/QBOSyncStatus.tsx | Sync status | components/settings/XeroSyncStatus.tsx |
| app/dashboard/settings/integrations/quickbooks/ | Settings pages | app/dashboard/settings/integrations/xero/ |

---

## Files to Create

| # | File Path | Purpose | Pattern |
|---|-----------|---------|---------|
| 1 | lib/integrations/xero/oauth.ts | Xero OAuth 2.0 | QBO oauth.ts |
| 2 | lib/integrations/xero/sync-contacts.ts | Contact sync | QBO sync pattern |
| 3 | lib/integrations/xero/sync-invoices.ts | Invoice sync | QBO sync pattern |
| 4 | lib/integrations/xero/sync-expenses.ts | Expense sync | QBO sync-expenses.ts |
| 5 | app/api/integrations/xero/connect/route.ts | OAuth connect | QBO connect route |
| 6 | app/api/integrations/xero/callback/route.ts | OAuth callback | QBO callback route |
| 7 | app/api/integrations/xero/sync/route.ts | Trigger sync | QBO sync route |
| 8 | app/api/integrations/xero/webhook/route.ts | Xero webhooks | QBO webhook route |
| 9 | components/settings/XeroAccountMapping.tsx | Account mapping | QBOAccountMapping.tsx |
| 10 | components/settings/XeroSyncStatus.tsx | Sync dashboard | QBOSyncStatus.tsx |
| 11 | app/dashboard/settings/integrations/xero/page.tsx | Xero settings | QBO settings page |

---

## Parallel Work Plan

### Batch 1
| Agent | Task | Est. Tokens |
|-------|------|-------------|
| Agent 1 | Xero OAuth lib + API routes | ~30k |
| Agent 2 | Contact + invoice + expense sync modules | ~40k |
| Agent 3 | Account mapping UI + sync status | ~30k |

### Batch 2
| Agent | Task | Est. Tokens |
|-------|------|-------------|
| Agent 4 | Settings page + webhook handler + integration | ~25k |

---

## Acceptance Criteria

- [ ] Xero OAuth connection flow works
- [ ] Contact sync (Clients ↔ Xero Contacts)
- [ ] Invoice sync (push to Xero, pull payment status)
- [ ] Expense sync (push approved expenses)
- [ ] Account mapping UI functional
- [ ] Sync status dashboard shows last sync time + errors
- [ ] npx tsc --noEmit passes

---

## Estimated Token Budget: ~125k
